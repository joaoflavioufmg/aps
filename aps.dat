#############################################################################
# Operations Research for Health Care
# Author: João Flávio de Freitas Almeida <joao.flavio@dep.ufmg.br>
# LEPOINT: Laboratório de Estudos em Planejamento de Operações Integradas
# Departmento de Engenharia de Produção
# Universidade Federal de Minas Gerais - Escola de Engenharia
#############################################################################
# Health Care Facility Location Problem: Considering fixed facilities, 
# choose intermediate facilities accorting a criteria that improve service
# quality. Consider health care teams. 
#############################################################################
# glpsol -m aps.mod -d aps.dat --cuts

data;

################################################
# BUDGET, INVESTMENT PARAMETER
param BUDGET := 200000000; # Overall budget constraint ($/year)
param I_L1 := 4000000;
################################################

# Health care levels (PHC, SHC, THC)
# Maximal distance for each level
param: K: Dmax :=
1         5000 # PHC: Primary health care (basic care)
2         60000 # SHC: Secondary health care (intermediate care)
3         120000 # THC: Tertiary health care (hospital care)
;

set L[1] := PHC1 PHC2 PHC3 PHC4 PHC5 PHC6 PHC7 PHC8 PHC9 PHC10;
set L[2] := SHC1 SHC2 SHC3 SHC4 SHC5 SHC6 SHC7 SHC8;
set L[3] := THC1 THC2 THC3 THC4 THC5 THC6;

# Basic health care units teams (PHC)
set E[1] :=
eSF # Equipe de Saúde da Família
eSB # Equipe de Saúde Bucal
eMulti # Equipe Multi
;

# Intermediate health care units teams (SHC)
set E[2] :=
ME2 # Clinical physician
EF2 # Nurse
DE2 # Dentist
;

# Tertiary health care units teams (Hospital)
set E[3] :=
ME3 # Clinical physician
EF3 # Nurse
DE3 # Dentist
;

# EXISTING health care units on three levels
set EL[1] := PHC1 PHC2 PHC3 PHC4 PHC5 PHC6;
set EL[2] := SHC1 SHC2 SHC3 SHC4;
set EL[3] := THC1 THC2 THC3;

# # CANDIDADE health care LOCATIONS on three levels
# set CL[1] := PHC7 PHC8 PHC9 PHC10;
# set CL[2] := SHC5 SHC6 SHC7 SHC8;
# set CL[3] := THC4 THC5 THC6;

# of type p at demand point i and 
# vulnerability V (the higher vulnerability, the worse)	
param:I:    W       IVS:=	
1           1000 	0.323
2           3000 	0.337
3           2000 	0.461
4           4000 	0.357
5           1000 	0.323
6           1000 	0.427
7           2000 	0.601
8           3000 	0.413
9           3000 	0.409
10          2000 	0.305
11          1000 	0.420
12          2000 	0.334
13          3000 	0.301
14          4000 	0.298
15          5000 	0.422
;

# # Variable cost of PHC j / patient 
param:	ITEM1   SIZE	FC1		VC1:=  
PHC1	1       1		1000	.
PHC2	2       2		2000	.
PHC3	3       2		2000	.
PHC4	4       1		1000	.
PHC5	5       2		2000	.
PHC6	6       1		1000	.
PHC7	7       2		3000	.
PHC8	8       2		5000	.
PHC9	9       2		5000	.
PHC10	10      5		10000	.
;

param:	ITEM2   FC2		VC2:=	
SHC1	1       200		10
SHC2	2       200		10
SHC3	3       200		10
SHC4	4       200		10
SHC5	5       2000	10
SHC6	6       2000	10
SHC7	7       2000	10
SHC8	8       2000	10
;

param:	ITEM3   FC3		VC3:=	
THC1	1       300		20
THC2	2       300		20
THC3	3       300		20
THC4	4       300		20
THC5	5       3000	20
THC6	6       3000	20
;


# Team cost K1 ($/year)
param CE1:=
eSF     1500000
eSB     600000
eMulti  600000
;

# Team cost K2 ($/year)
param CE2:=
ME2     2000000
EF2     2000000
DE2     2000000
;

# Team cost K3 ($/year)
param CE3:=
ME3     3000000
EF3     3000000
DE3     3000000
;

param D0_1:=
1	PHC1	9291
1	PHC2	11034
1	PHC3	14645
1	PHC4	1857
1	PHC5	9974
1	PHC6	4729
1	PHC7	12113
1	PHC8	6027
1	PHC9	7858
1	PHC10	2975
2	PHC1	804
2	PHC2	5071
2	PHC3	3327
2	PHC4	11885
2	PHC5	9445
2	PHC6	14117
2	PHC7	9141
2	PHC8	1905
2	PHC9	5278
2	PHC10	7825
3	PHC1	6036
3	PHC2	8656
3	PHC3	3950
3	PHC4	1685
3	PHC5	5206
3	PHC6	2590
3	PHC7	11526
3	PHC8	9062
3	PHC9	1620
3	PHC10	7053
4	PHC1	6378
4	PHC2	3322
4	PHC3	1993
4	PHC4	12302
4	PHC5	8444
4	PHC6	9464
4	PHC7	10057
4	PHC8	11651
4	PHC9	3709
4	PHC10	5307
5	PHC1	10827
5	PHC2	3041
5	PHC3	2455
5	PHC4	13194
5	PHC5	1477
5	PHC6	11371
5	PHC7	5245
5	PHC8	4891
5	PHC9	13673
5	PHC10	11535
6	PHC1	2461
6	PHC2	10141
6	PHC3	11198
6	PHC4	3545
6	PHC5	14205
6	PHC6	4363
6	PHC7	1928
6	PHC8	7483
6	PHC9	13539
6	PHC10	13444
7	PHC1	13295
7	PHC2	14226
7	PHC3	7396
7	PHC4	11231
7	PHC5	14859
7	PHC6	6365
7	PHC7	1294
7	PHC8	4536
7	PHC9	12205
7	PHC10	2272
8	PHC1	12102
8	PHC2	6278
8	PHC3	7201
8	PHC4	11037
8	PHC5	5642
8	PHC6	3257
8	PHC7	1175
8	PHC8	4340
8	PHC9	6520
8	PHC10	9983
9	PHC1	11426
9	PHC2	7442
9	PHC3	13807
9	PHC4	3204
9	PHC5	7391
9	PHC6	12268
9	PHC7	5043
9	PHC8	9112
9	PHC9	1762
9	PHC10	1781
10	PHC1	10656
10	PHC2	6434
10	PHC3	6125
10	PHC4	9260
10	PHC5	10913
10	PHC6	1398
10	PHC7	3479
10	PHC8	5769
10	PHC9	13628
10	PHC10	1198
11	PHC1	9224
11	PHC2	6106
11	PHC3	3464
11	PHC4	10935
11	PHC5	7182
11	PHC6	3242
11	PHC7	1805
11	PHC8	1907
11	PHC9	14561
11	PHC10	3803
12	PHC1	9750
12	PHC2	14228
12	PHC3	6493
12	PHC4	3475
12	PHC5	6985
12	PHC6	5241
12	PHC7	1981
12	PHC8	2312
12	PHC9	9650
12	PHC10	11125
13	PHC1	14694
13	PHC2	4308
13	PHC3	4970
13	PHC4	13027
13	PHC5	1926
13	PHC6	6917
13	PHC7	11087
13	PHC8	1902
13	PHC9	13134
13	PHC10	3376
14	PHC1	5809
14	PHC2	1147
14	PHC3	11372
14	PHC4	8611
14	PHC5	2320
14	PHC6	11694
14	PHC7	10540
14	PHC8	11740
14	PHC9	3032
14	PHC10	11790
15	PHC1	13030
15	PHC2	4509
15	PHC3	9294
15	PHC4	2737
15	PHC5	12623
15	PHC6	8055
15	PHC7	2183
15	PHC8	2136
15	PHC9	9006
15	PHC10	6169
;

param D0_2:=
1	SHC1	19096
1	SHC2	26366
1	SHC3	82121
1	SHC4	21339
1	SHC5	39297
1	SHC6	29648
1	SHC7	74578
1	SHC8	12149
2	SHC1	74496
2	SHC2	59251
2	SHC3	10524
2	SHC4	16966
2	SHC5	36852
2	SHC6	15222
2	SHC7	47292
2	SHC8	98827
3	SHC1	35568
3	SHC2	21619
3	SHC3	61926
3	SHC4	32182
3	SHC5	21145
3	SHC6	81118
3	SHC7	91055
3	SHC8	74996
4	SHC1	11682
4	SHC2	67915
4	SHC3	59249
4	SHC4	55462
4	SHC5	49292
4	SHC6	75305
4	SHC7	71333
4	SHC8	94009
5	SHC1	38702
5	SHC2	98689
5	SHC3	87994
5	SHC4	13482
5	SHC5	53839
5	SHC6	11655
5	SHC7	17407
5	SHC8	11274
6	SHC1	34425
6	SHC2	69564
6	SHC3	61932
6	SHC4	20245
6	SHC5	85023
6	SHC6	52155
6	SHC7	88909
6	SHC8	67519
7	SHC1	56735
7	SHC2	28821
7	SHC3	40591
7	SHC4	30788
7	SHC5	66996
7	SHC6	47057
7	SHC7	53695
7	SHC8	13449
8	SHC1	40761
8	SHC2	69990
8	SHC3	43571
8	SHC4	85213
8	SHC5	82748
8	SHC6	59993
8	SHC7	31319
8	SHC8	48234
9	SHC1	53149
9	SHC2	97832
9	SHC3	30357
9	SHC4	22981
9	SHC5	51527
9	SHC6	37670
9	SHC7	65552
9	SHC8	94811
10	SHC1	76686
10	SHC2	83750
10	SHC3	77331
10	SHC4	27882
10	SHC5	52900
10	SHC6	72537
10	SHC7	73230
10	SHC8	64619
11	SHC1	85453
11	SHC2	44822
11	SHC3	26648
11	SHC4	85614
11	SHC5	40226
11	SHC6	48502
11	SHC7	45638
11	SHC8	10631
12	SHC1	94566
12	SHC2	65272
12	SHC3	79102
12	SHC4	77072
12	SHC5	15775
12	SHC6	21482
12	SHC7	62626
12	SHC8	75161
13	SHC1	80506
13	SHC2	74041
13	SHC3	23226
13	SHC4	13402
13	SHC5	45022
13	SHC6	54559
13	SHC7	26397
13	SHC8	83208
14	SHC1	42326
14	SHC2	57426
14	SHC3	22080
14	SHC4	38602
14	SHC5	13212
14	SHC6	43468
14	SHC7	80277
14	SHC8	77435
15	SHC1	16474
15	SHC2	88479
15	SHC3	78583
15	SHC4	60396
15	SHC5	82630
15	SHC6	47870
15	SHC7	72222
15	SHC8	65323
;

param D0_3:=
1	THC1	28183
1	THC2	68877
1	THC3	32096
1	THC4	65730
1	THC5	113401
1	THC6	91268
2	THC1	125748
2	THC2	82207
2	THC3	149982
2	THC4	142286
2	THC5	84424
2	THC6	104250
3	THC1	79394
3	THC2	147855
3	THC3	139174
3	THC4	136089
3	THC5	96961
3	THC6	68945
4	THC1	62429
4	THC2	136677
4	THC3	131072
4	THC4	62517
4	THC5	129146
4	THC6	67230
5	THC1	119180
5	THC2	57121
5	THC3	136105
5	THC4	138678
5	THC5	117846
5	THC6	149355
6	THC1	59272
6	THC2	138340
6	THC3	39707
6	THC4	89010
6	THC5	83970
6	THC6	57832
7	THC1	30444
7	THC2	51231
7	THC3	111352
7	THC4	55429
7	THC5	51881
7	THC6	134115
8	THC1	146073
8	THC2	48539
8	THC3	50690
8	THC4	86908
8	THC5	98636
8	THC6	146901
9	THC1	62584
9	THC2	138340
9	THC3	64496
9	THC4	112523
9	THC5	129671
9	THC6	112515
10	THC1	37277
10	THC2	83836
10	THC3	144221
10	THC4	143063
10	THC5	108620
10	THC6	60753
11	THC1	35470
11	THC2	131562
11	THC3	109797
11	THC4	73296
11	THC5	77995
11	THC6	94449
12	THC1	97519
12	THC2	119285
12	THC3	93452
12	THC4	95192
12	THC5	126732
12	THC6	31155
13	THC1	79383
13	THC2	61715
13	THC3	111077
13	THC4	137176
13	THC5	137270
13	THC6	55379
14	THC1	118882
14	THC2	138819
14	THC3	104948
14	THC4	144021
14	THC5	148701
14	THC6	120982
15	THC1	26505
15	THC2	128996
15	THC3	138916
15	THC4	42675
15	THC5	58216
15	THC6	140987
;

param D1_2:= 
PHC1	SHC1	22884
PHC1	SHC2	14300
PHC1	SHC3	24696
PHC1	SHC4	26099
PHC1	SHC5	17508
PHC1	SHC6	24548
PHC1	SHC7	18248
PHC1	SHC8	11104
PHC2	SHC1	13659
PHC2	SHC2	19991
PHC2	SHC3	28256
PHC2	SHC4	19367
PHC2	SHC5	15825
PHC2	SHC6	25071
PHC2	SHC7	19541
PHC2	SHC8	23579
PHC3	SHC1	25487
PHC3	SHC2	21206
PHC3	SHC3	25218
PHC3	SHC4	19718
PHC3	SHC5	10064
PHC3	SHC6	22808
PHC3	SHC7	24854
PHC3	SHC8	23586
PHC4	SHC1	23072
PHC4	SHC2	27787
PHC4	SHC3	28316
PHC4	SHC4	13926
PHC4	SHC5	28904
PHC4	SHC6	26308
PHC4	SHC7	21678
PHC4	SHC8	26626
PHC5	SHC1	24911
PHC5	SHC2	24459
PHC5	SHC3	12001
PHC5	SHC4	29510
PHC5	SHC5	10754
PHC5	SHC6	29327
PHC5	SHC7	26989
PHC5	SHC8	16442
PHC6	SHC1	27484
PHC6	SHC2	16238
PHC6	SHC3	12929
PHC6	SHC4	16952
PHC6	SHC5	27465
PHC6	SHC6	12552
PHC6	SHC7	19688
PHC6	SHC8	26897
PHC7	SHC1	16085
PHC7	SHC2	25986
PHC7	SHC3	21276
PHC7	SHC4	16097
PHC7	SHC5	12581
PHC7	SHC6	24154
PHC7	SHC7	15142
PHC7	SHC8	28086
PHC8	SHC1	25874
PHC8	SHC2	10912
PHC8	SHC3	29591
PHC8	SHC4	28950
PHC8	SHC5	21743
PHC8	SHC6	27007
PHC8	SHC7	16937
PHC8	SHC8	13253
PHC9	SHC1	25234
PHC9	SHC2	29387
PHC9	SHC3	20968
PHC9	SHC4	17404
PHC9	SHC5	19850
PHC9	SHC6	13576
PHC9	SHC7	16914
PHC9	SHC8	18736
PHC10	SHC1	11878
PHC10	SHC2	15587
PHC10	SHC3	10957
PHC10	SHC4	13422
PHC10	SHC5	26736
PHC10	SHC6	18589
PHC10	SHC7	29025
PHC10	SHC8	13758
;

param D1_3:=
PHC1	THC1	99506
PHC1	THC2	49359
PHC1	THC3	28740
PHC1	THC4	62632
PHC1	THC5	58692
PHC1	THC6	26758
PHC2	THC1	59069
PHC2	THC2	91649
PHC2	THC3	65516
PHC2	THC4	64314
PHC2	THC5	55983
PHC2	THC6	90805
PHC3	THC1	33285
PHC3	THC2	71726
PHC3	THC3	91034
PHC3	THC4	24330
PHC3	THC5	60044
PHC3	THC6	56780
PHC4	THC1	39280
PHC4	THC2	84029
PHC4	THC3	99995
PHC4	THC4	86597
PHC4	THC5	83485
PHC4	THC6	18965
PHC5	THC1	55794
PHC5	THC2	57374
PHC5	THC3	93969
PHC5	THC4	92963
PHC5	THC5	67998
PHC5	THC6	99472
PHC6	THC1	64730
PHC6	THC2	70042
PHC6	THC3	68439
PHC6	THC4	28059
PHC6	THC5	77995
PHC6	THC6	28824
PHC7	THC1	37333
PHC7	THC2	52918
PHC7	THC3	73890
PHC7	THC4	32393
PHC7	THC5	59458
PHC7	THC6	18250
PHC8	THC1	34168
PHC8	THC2	28454
PHC8	THC3	95374
PHC8	THC4	34359
PHC8	THC5	54416
PHC8	THC6	83549
PHC9	THC1	96566
PHC9	THC2	60311
PHC9	THC3	20498
PHC9	THC4	26059
PHC9	THC5	57811
PHC9	THC6	55451
PHC10	THC1	40313
PHC10	THC2	40122
PHC10	THC3	38987
PHC10	THC4	54717
PHC10	THC5	43696
PHC10	THC6	48905
;

param D2_3:= 
SHC1	THC1	44878
SHC1	THC2	46949
SHC1	THC3	16214
SHC1	THC4	45174
SHC1	THC5	45018
SHC1	THC6	19825
SHC2	THC1	36838
SHC2	THC2	37074
SHC2	THC3	26358
SHC2	THC4	57613
SHC2	THC5	29276
SHC2	THC6	52114
SHC3	THC1	31855
SHC3	THC2	51053
SHC3	THC3	47200
SHC3	THC4	54467
SHC3	THC5	35406
SHC3	THC6	25893
SHC4	THC1	43906
SHC4	THC2	21931
SHC4	THC3	45110
SHC4	THC4	40400
SHC4	THC5	34769
SHC4	THC6	23632
SHC5	THC1	25099
SHC5	THC2	33309
SHC5	THC3	57181
SHC5	THC4	29945
SHC5	THC5	35471
SHC5	THC6	53252
SHC6	THC1	59662
SHC6	THC2	35784
SHC6	THC3	29594
SHC6	THC4	26249
SHC6	THC5	50079
SHC6	THC6	34284
SHC7	THC1	29814
SHC7	THC2	17237
SHC7	THC3	39314
SHC7	THC4	34711
SHC7	THC5	58100
SHC7	THC6	16554
SHC8	THC1	42156
SHC8	THC2	46017
SHC8	THC3	19086
SHC8	THC4	31529
SHC8	THC5	50186
SHC8	THC6	24363
;

param DL1:=
PHC1	PHC1	0
PHC1	PHC2	25490
PHC1	PHC3	6485
PHC1	PHC4	23716
PHC1	PHC5	6158
PHC1	PHC6	29191
PHC1	PHC7	3612
PHC1	PHC8	16824
PHC1	PHC9	6151
PHC1	PHC10	5942
PHC2	PHC1	19945
PHC2	PHC2	0
PHC2	PHC3	21843
PHC2	PHC4	19347
PHC2	PHC5	21740
PHC2	PHC6	21872
PHC2	PHC7	10396
PHC2	PHC8	2195
PHC2	PHC9	22027
PHC2	PHC10	16173
PHC3	PHC1	12608
PHC3	PHC2	27327
PHC3	PHC3	0
PHC3	PHC4	12534
PHC3	PHC5	1867
PHC3	PHC6	2796
PHC3	PHC7	7926
PHC3	PHC8	1761
PHC3	PHC9	16037
PHC3	PHC10	12942
PHC4	PHC1	26279
PHC4	PHC2	10067
PHC4	PHC3	25361
PHC4	PHC4	0
PHC4	PHC5	27620
PHC4	PHC6	3345
PHC4	PHC7	23355
PHC4	PHC8	22228
PHC4	PHC9	5943
PHC4	PHC10	29000
PHC5	PHC1	28584
PHC5	PHC2	1986
PHC5	PHC3	18964
PHC5	PHC4	4122
PHC5	PHC5	0
PHC5	PHC6	16559
PHC5	PHC7	7916
PHC5	PHC8	15759
PHC5	PHC9	8778
PHC5	PHC10	9212
PHC6	PHC1	14832
PHC6	PHC2	11220
PHC6	PHC3	22375
PHC6	PHC4	14341
PHC6	PHC5	10302
PHC6	PHC6	0
PHC6	PHC7	14438
PHC6	PHC8	27547
PHC6	PHC9	5294
PHC6	PHC10	6033
;


param DL2:=
SHC1	SHC1	0
SHC1	SHC2	29092
SHC1	SHC3	56923
SHC1	SHC4	43136
SHC1	SHC5	65690
SHC1	SHC6	40650
SHC1	SHC7	67705
SHC1	SHC8	62823
SHC2	SHC1	52345
SHC2	SHC2	0
SHC2	SHC3	44369
SHC2	SHC4	21909
SHC2	SHC5	35942
SHC2	SHC6	17378
SHC2	SHC7	53760
SHC2	SHC8	54667
SHC3	SHC1	27412
SHC3	SHC2	66230
SHC3	SHC3	0
SHC3	SHC4	18230
SHC3	SHC5	22479
SHC3	SHC6	47286
SHC3	SHC7	21816
SHC3	SHC8	39947
SHC4	SHC1	61499
SHC4	SHC2	64522
SHC4	SHC3	18984
SHC4	SHC4	0
SHC4	SHC5	22857
SHC4	SHC6	65336
SHC4	SHC7	46058
SHC4	SHC8	16671
;

param DL3:=
THC1	THC1	0
THC1	THC2	56121
THC1	THC3	53150
THC1	THC4	56898
THC1	THC5	52952
THC1	THC6	46456
THC2	THC1	61140
THC2	THC2	0
THC2	THC3	21121
THC2	THC4	34471
THC2	THC5	65908
THC2	THC6	53421
THC3	THC1	67195
THC3	THC2	40273
THC3	THC3	0
THC3	THC4	45387
THC3	THC5	52448
THC3	THC6	75739
;

param CNES1
:	PHC1 PHC2 PHC3 PHC4 PHC5 PHC6:=
eSF	4	1	1	1	2	1
eSB	1	3	1	3	1	1
eMulti	1	0	0	1	0	1
;											

param CNES2
:	SHC1 SHC2 SHC3 SHC4:=
ME2	3	1	3	2
EF2	3	1	1	1
DE2	3	3	3	1
;									

param CNES3
:	THC1 THC2 THC3:=
ME3 1	2	1
EF3 1	0	1
DE3 1	0	2
;
									

param C2:=
SHC1	2000
SHC2	2000
SHC3	2000
SHC4	2000
SHC5	2000
SHC6	2000
SHC7	2000
SHC8	2000
;

param C3:=	
THC1	800
THC2	500
THC3	500
THC4	500
THC5	500
THC6	500
;	

# The number of alevel-k to be established.
param U:=
1	2
2	3
3	2
; 

# Primary care facility (PCF)  — O1_0  O1_2  O1_3
# The proportion of patients in a L-1 to i in I, and L-3 PCF.
param: O1_0   O1_2   O1_3 :=
PHC1   0.71   0.20   0.05
PHC2   0.71   0.20   0.05
PHC3   0.71   0.20   0.05
PHC4   0.71   0.20   0.05
PHC5   0.71   0.20   0.05
PHC6   0.71   0.20   0.05
PHC7   0.71   0.20   0.05
PHC8   0.71   0.20   0.05
PHC9   0.71   0.20   0.05
PHC10  0.71   0.20   0.05
;

# Secondary care facility (SCF) — O2_0  O2_1  O2_3
# The proportion of patients in a L-2 to i in I,, L-1 and L-3 SCF.
param: O2_0   O2_1   O2_3 :=
SHC1   0.65   0.20   0.10
SHC2   0.65   0.20   0.10
SHC3   0.65   0.20   0.10
SHC4   0.65   0.20   0.10
SHC5   0.65   0.20   0.10
SHC6   0.65   0.20   0.10
SHC7   0.65   0.20   0.10
SHC8   0.65   0.20   0.10
;

# Tertiary care facility (TCF) — O3_0  O3_1  O3_2
# The proportion of patients in a L-3 to i in I, L-1 and L-2 TCF.
param: O3_0   O3_1   O3_2 :=
THC1   0.80   0.10   0.05
THC2   0.80   0.10   0.05
THC3   0.80   0.10   0.05
THC4   0.80   0.10   0.05
THC5   0.80   0.10   0.05
THC6   0.80   0.10   0.05
;


# Percentual maximo de Atendimentos Telemedicina de casa > PHC, SHC, THC
param MAX_TELE_PHC := 0.05;
param MAX_TELE_SHC := 0.05;
param MAX_TELE_THC := 0.05;

# Percentual maximo de deslocamentos Casa > PHC, SHC, THC 
param MAX_HOME_PHC := 1.00;
param MAX_HOME_SHC := 0.15;
param MAX_HOME_THC := 0.05;
#################################################

end;


