#############################################################################
# Project CNPq: Increasing PHC with team sizing
# Author: João Flávio de Freitas Almeida <joao.flavio@dep.ufmg.br>
# LEPOINT: Laboratório de Estudos em Planejamento de Operações Integradas
# Departmento de Engenharia de Produção
# Universidade Federal de Minas Gerais - Escola de Engenharia
#############################################################################
# Health Care Facility Location Problem: Considering fixed facilities, 
# choose intermediate facilities accorting a criteria that improve service
# quality. Consider health care teams. 
#############################################################################
# glpsol -m aps.mod -d LS.dat --cuts


data;

# Health care levels (PHC, SHC, THC)
# Maximal distance for each level
param: K: Dmax :=
1         20000 # PHC: Primary health care (basic care)
2         40000 # SHC: Secondary health care (intermediate care)
3         55000 # THC: Tertiary health care (hospital care)
;


set L[2] := SHC1;
set L[3] := THC1;

# Basic health care units teams (PHC)
set E[1] :=
eSF # Equipe de Saúde da Família
eSB # Equipe de Saúde Bucal
eMulti # Equipe Multi
;

# Intermediate health care units teams (SHC)
set E[2] :=
EQ2 # Equipe SHC
;

# Tertiary health care units teams (Hospital)
set E[3] :=
EQ3 # Equipe SHC
;


# EXISTING health care units on three levels
set EL[1] := 
313760105000013
313760105000076
313760105000102
313760105000122
313760105000125
313760105000132
313760105000135
313760105000139
313760105000168
313760105000186
313760105000201
313760105000235
313760105000239
313760105000259
313760105000264
;

set EL[2] := SHC1;
set EL[3] := THC1;



# of type p at demand point i and 
# vulnerability V (the higher vulnerability, the worse)	
# id_setor	populacao	IVS
param: I: W   IVS:=	
313760105000002	253	0.423
313760105000003	332	0.437
313760105000004	0	.
313760105000005	502	0.461
313760105000007	312	0.457
313760105000008	505	0.423
313760105000009	426	0.427
313760105000010	294	0.401
313760105000011	305	0.413
313760105000012	543	0.409
313760105000013	620	0.405
313760105000015	607	0.42
313760105000016	139	0.434
313760105000020	380	0.426
313760105000021	280	0.441
313760105000022	245	0.414
313760105000024	94	0.422
313760105000026	347	0.431
313760105000027	582	0.418
313760105000028	317	0.442
313760105000029	191	0.43
313760105000030	231	0.441
313760105000036	251	0.434
313760105000037	418	0.408
313760105000039	701	0.301
313760105000040	390	0.298
313760105000043	448	0.422
313760105000045	401	0.439
313760105000048	36	0.476
313760105000050	3	0.658
313760105000058	177	0.434
313760105000064	390	0.443
313760105000066	358	0.44
313760105000067	193	0.434
313760105000068	195	0.443
313760105000069	114	0.431
313760105000071	294	0.441
313760105000072	311	0.424
313760105000074	428	0.424
313760105000075	174	0.412
313760105000076	179	0.407
313760105000077	314	0.412
313760105000078	238	0.395
313760105000080	263	0.393
313760105000081	184	0.419
313760105000082	176	0.413
313760105000083	373	0.416
313760105000084	151	0.423
313760105000085	182	0.436
313760105000086	390	0.416
313760105000087	179	0.426
313760105000088	331	0.42
313760105000089	219	0.402
313760105000090	533	0.402
313760105000091	339	0.405
313760105000092	58	0.476
313760105000094	505	0.406
313760105000095	295	0.435
313760105000096	180	0.42
313760105000097	179	0.434
313760105000098	193	0.453
313760105000099	467	0.402
313760105000101	37	0.4
313760105000102	1106	0.41
313760105000103	301	0.42
313760105000105	585	0.395
313760105000106	773	0.416
313760105000108	166	0.439
313760105000109	397	0.418
313760105000110	359	0.441
313760105000112	86	0.446
313760105000114	11	0.658
313760105000115	0	.
313760105000118	301	0.407
313760105000120	330	0.392
313760105000122	378	0.398
313760105000123	99	0.447
313760105000124	206	0.424
313760105000125	124	0.425
313760105000126	178	0.411
313760105000127	425	0.435
313760105000128	773	0.407
313760105000129	378	0.404
313760105000132	336	0.434
313760105000133	493	0.405
313760105000134	253	0.42
313760105000135	340	0.436
313760105000136	302	0.406
313760105000138	554	0.393
313760105000139	324	0.389
313760105000140	527	0.425
313760105000141	200	0.424
313760105000142	226	0.45
313760105000144	84	0.356
313760105000145	382	0.402
313760105000146	68	0.426
313760105000147	306	0.422
313760105000150	545	0.428
313760105000151	290	0.453
313760105000152	124	0.417
313760105000161	452	0.406
313760105000162	327	0.4
313760105000163	322	0.396
313760105000164	490	0.436
313760105000165	265	0.43
313760105000166	385	0.429
313760105000167	333	0.409
313760105000168	312	0.427
313760105000169	241	0.435
313760105000170	417	0.409
313760105000171	382	0.414
313760105000172	123	0.421
313760105000173	187	0.455
313760105000174	153	0.459
313760105000175	238	0.427
313760105000176	316	0.451
313760105000177	320	0.376
313760105000178	361	0.392
313760105000179	231	0.381
313760105000180	373	0.4
313760105000181	0	.
313760105000182	507	0.397
313760105000183	614	0.437
313760105000184	404	0.455
313760105000185	388	0.438
313760105000186	252	0.429
313760105000187	428	0.447
313760105000188	359	0.395
313760105000189	218	0.414
313760105000190	293	0.399
313760105000191	360	0.402
313760105000192	92	0.406
313760105000193	438	0.427
313760105000194	8	0.658
313760105000195	79	0.421
313760105000196	131	0.399
313760105000198	262	0.471
313760105000199	413	0.421
313760105000200	250	0.443
313760105000201	293	0.433
313760105000202	372	0.418
313760105000203	369	0.419
313760105000204	311	0.411
313760105000205	142	0.42
313760105000206	109	0.429
313760105000207	390	0.416
313760105000208	405	0.426
313760105000209	619	0.4
313760105000210	48	0.429
313760105000211	240	0.441
313760105000212	154	0.42
313760105000213	321	0.377
313760105000214	371	0.412
313760105000215	189	0.418
313760105000216	178	0.419
313760105000217	369	0.412
313760105000218	561	0.394
313760105000219	562	0.409
313760105000220	287	0.419
313760105000221	2	0.658
313760105000222	164	0.42
313760105000223	443	0.396
313760105000224	179	0.402
313760105000225	217	0.406
313760105000226	399	0.401
313760105000227	546	0.281
313760105000228	288	0.404
313760105000229	578	0.4
313760105000230	90	0.402
313760105000231	120	0.425
313760105000232	326	0.41
313760105000233	121	0.441
313760105000234	388	0.434
313760105000235	393	0.398
313760105000236	309	0.42
313760105000237	411	0.404
313760105000238	331	0.415
313760105000239	443	0.407
313760105000240	240	0.411
313760105000241	358	0.412
313760105000242	282	0.444
313760105000243	366	0.432
313760105000244	0	.
313760105000245	111	0.417
313760105000246	174	0.442
313760105000247	148	0.432
313760105000248	320	0.413
313760105000249	177	0.403
313760105000250	152	0.388
313760105000251	165	0.405
313760105000252	348	0.433
313760105000253	330	0.404
313760105000254	206	0.412
313760105000255	302	0.384
313760105000256	133	0.411
313760105000257	184	0.404
313760105000258	303	0.423
313760105000259	423	0.426
313760105000260	227	0.372
313760105000261	271	0.384
313760105000262	356	0.386
313760105000263	3	0.658
313760105000264	324	0.406
313760105000265	329	0.412
313760105000266	305	0.268
313760105000267	264	0.399
313760105000268	399	0.398
313760105000269	424	0.414
313760105000270	343	0.397
313760105000271	326	0.416
313760105000272	427	0.408
313760105000273	402	0.435
313760105000274	341	0.407
313760105000275	344	0.397
313760105000276	486	0.427
313760105000277	145	0.4
313760105000278	656	0.405
313760105000279	346	0.413
313760105000280	331	0.418
313760105000281	151	0.289
313760105000282	329	0.415
313760105000283	478	0.428
313760105000284	64	0.429
313760105000285	181	0.413
313760114000002	133	.
313760114000007	345	.
313760114000008	270	.
313760114000009	23	.
313760114000010	9	.
313760115000001	165	.
313760115000002	92	.
313760115000003	412	.
313760115000005	74	.
313760115000006	4	.
313760115000007	51	.
313760115000008	354	.
313760115000009	279	.
313760115000010	135	.
313760115000011	356	.
313760115000014	182	.
313760115000015	8	.
313760115000018	394	.
313760115000019	43	.
313760115000020	925	.
313760115000021	163	.
313760115000022	243	.
313760115000023	54	.
313760115000024	303	.
313760115000025	334	.
313760115000026	271	.
313760115000027	339	.
313760115000029	122	.
313760115000030	73	.
313760115000031	352	.
313760115000032	340	.
313760115000033	248	.
313760115000034	231	.
;

# # Variable cost of PHC j / patient 
param:	        SIZE	FC1		VC1:=   #   Código UBS (CNES)
313760105000013	1	    80000	3	#	3137605402034
313760105000076	1	    80000	3	#	3137602116553
313760105000102	2	    90000	3	#	3137605324920
313760105000122	1	    80000	3	#	3137602168332
313760105000125	1	    80000	3	#	3137605324912
313760105000132	1	    80000	3	#	3137602116588
313760105000135	2	    90000	3	#	3137605402417
313760105000139	2	    90000	3	#	3137602117363
313760105000168	1	    80000	3	#	3137605324904
313760105000186	1	    80000	3	#	3137602116537
313760105000201	1	    80000	3	#	3137602116545
313760105000235	1	    80000	3	#	3137605402425
313760105000239	2	    90000	3	#	3137602116561
313760105000259	1	    80000	3	#	3137604334663
313760105000264	1	    80000	3	#	3137609342923
;

param:	FC2		VC2:=	
SHC1	200000		10
;

param:	FC3		VC3:=	
THC1	300000		20
;

################################################
# BUDGET PARAMETER
param BUDGET := 16430000; # Overall budget constraint ($/year)
################################################

# Team cost K1 ($/year)
# 		Folha mensal	Encargos	Insumos	Transporte	Supervisão
# eSF	 R$ 1.455.500.00 	50000	45000	7500	3500	5000
# eSB	 R$ 640.420.00 	22000	19800	3300	1540	2200
# eMulti (1/9)	 R$ 611.595.56 	92000	82800	13800	6440	9200
# Fonte: Planilha APS_dados.xlsx
param CE1:=
eSF 1455500
eSB 640420
eMulti 611595
;

# Team cost K2 ($/year)
param CE2:=
EQ2 0
;

# Team cost K3 ($/year)
param CE3:=
EQ3 0
;


param CNES1(tr):	eSF	eSB	eMulti:=
313760105000013	    1	0	0	
313760105000076	    1	1	0	
313760105000102	    2	1	0	
313760105000122	    1	1	0	
313760105000125	    1	1	0	
313760105000132	    1	1	0	
313760105000135	    2	1	0	
313760105000139	    2	2	1	
313760105000168	    1	1	0	
313760105000186	    1	1	0	
313760105000201	    1	1	1	
313760105000235	    1	1	1	
313760105000239	    2	2	1	
313760105000259	    1	0	0	
313760105000264	    1	0	0	
;
										

param CNES2
:	SHC1 :=
EQ2	3	

;									

param CNES3
:	THC1 :=
EQ3 2	
;							

param C2:=
SHC1	200000
;

param C3:=	
THC1	800000
;

# The number of alevel-k to be established.
param U:=
1	40
2	40
3	40
; 

# Primary care facility (PCF)  — O1_0  O1_2  O1_3
# The proportion of patients in a L-1 to i in I, and L-3 PCF.
param 
:	            O1_0    O1_2    O1_3:=
313760105000013	0.71	0.2     0.05	
313760105000076	0.71	0.2	    0.05	
313760105000102	0.71	0.2	    0.05	
313760105000122	0.71	0.2	    0.05	
313760105000125	0.71	0.2	    0.05	
313760105000132	0.71	0.2	    0.05	
313760105000135	0.71	0.2	    0.05	
313760105000139	0.71	0.2	    0.05	
313760105000168	0.71	0.2	    0.05	
313760105000186	0.71	0.2	    0.05	
313760105000201	0.71	0.2	    0.05	
313760105000235	0.71	0.2	    0.05	
313760105000239	0.71	0.2	    0.05	
313760105000259	0.71	0.2	    0.05	
313760105000264	0.71	0.2	    0.05	
;

# Secondary care facility (SCF) — O2_0  O2_1  O2_3
# The proportion of patients in a L-2 to i in I,, L-1 and L-3 SCF.
param: O2_0   O2_1   O2_3 :=
SHC1   0.65   0.20   0.10
;

# Tertiary care facility (TCF) — O3_0  O3_1  O3_2
# The proportion of patients in a L-3 to i in I, L-1 and L-2 TCF.
param: O3_0   O3_1   O3_2 :=
THC1   0.80   0.10   0.05
;


# Percentual maximo de Atendimentos Telemedicina de casa > PHC, SHC, THC
param MAX_TELE_PHC := 0.05;
param MAX_TELE_SHC := 0.05;
param MAX_TELE_THC := 0.05;

# Percentual maximo de deslocamentos Casa > PHC, SHC, THC 
param MAX_HOME_PHC := 1.00;
param MAX_HOME_SHC := 0.15;
param MAX_HOME_THC := 0.05;
#################################################

end;

